(function(e){jQuery.fn.extend({slimScroll:function(n){var r=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);this.each(function(){function i(t){if(p){t=t||window.event;var n=0;t.wheelDelta&&(n=-t.wheelDelta/120);t.detail&&(n=t.detail/3);e(t.target||t.srcTarget||t.srcElement).closest("."+r.wrapperClass).is(x.parent())&&s(n,!0);t.preventDefault&&!S&&t.preventDefault();S||(t.returnValue=!1)}}function s(e,t,n){S=!1;var i=e,s=x.outerHeight()-N.outerHeight();t&&(i=parseInt(N.css("top"))+e*parseInt(r.wheelStep)/100*N.outerHeight(),i=Math.min(Math.max(i,0),s),i=0<e?Math.ceil(i):Math.floor(i),N.css({top:i+"px"}));b=parseInt(N.css("top"))/(x.outerHeight()-N.outerHeight());i=b*(x[0].scrollHeight-x.outerHeight());n&&(i=e,e=i/x[0].scrollHeight*x.outerHeight(),e=Math.min(Math.max(e,0),s),N.css({top:e+"px"}));x.scrollTop(i);x.trigger("slimscrolling",~~i);l();c()}function o(){window.addEventListener?(this.addEventListener("DOMMouseScroll",i,!1),this.addEventListener("mousewheel",i,!1),this.addEventListener("MozMousePixelScroll",i,!1)):document.attachEvent("onmousewheel",i)}function u(){y=Math.max(x.outerHeight()/x[0].scrollHeight*x.outerHeight(),E);N.css({height:y+"px"});var e=y==x.outerHeight()?"none":"block";N.css({display:e})}function l(){u();clearTimeout(m);b==~~b?(S=r.allowPageScroll,w!=b&&x.trigger("slimscroll",0==~~b?"top":"bottom")):S=!1;w=b;y>=x.outerHeight()?S=!0:(N.stop(!0,!0).fadeIn("fast"),r.railVisible&&C.stop(!0,!0).fadeIn("fast"))}function c(){r.alwaysVisible||(m=setTimeout(function(){r.disableFadeOut&&p||d||v||(N.fadeOut("slow"),C.fadeOut("slow"))},1e3))}var p,d,v,m,g,y,b,w,E=30,S=!1,x=e(this);if(x.parent().hasClass(r.wrapperClass)){var T=x.scrollTop(),N=x.parent().find("."+r.barClass),C=x.parent().find("."+r.railClass);u();if(e.isPlainObject(n)){if("height"in n&&"auto"==n.height){x.parent().css("height","auto");x.css("height","auto");var k=x.parent().parent().height();x.parent().css("height",k);x.css("height",k)}if("scrollTo"in n)T=parseInt(r.scrollTo);else if("scrollBy"in n)T+=parseInt(r.scrollBy);else if("destroy"in n){N.remove();C.remove();x.unwrap();return}else if("resize"in n){x.parent().css("height","auto");x.css("height","auto");var k=x.parent().parent().height();x.parent().css("height",k);x.css("height",k)}s(T,!1,!0)}}else{r.height="auto"==r.height?x.parent().height():r.height;T=e("<div></div>").addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});x.css({overflow:"hidden",width:r.width,height:r.height});var C=e("<div></div>").addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),N=e("<div></div>").addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),k="right"==r.position?{right:r.distance}:{left:r.distance};C.css(k);N.css(k);x.wrap(T);x.parent().append(N);x.parent().append(C);r.railDraggable&&N.bind("mousedown",function(n){var r=e(document);v=!0;t=parseFloat(N.css("top"));pageY=n.pageY;r.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY;N.css("top",currTop);s(0,N.position().top,!1)});r.bind("mouseup.slimscroll",function(e){v=!1;c();r.unbind(".slimscroll")});return!1}).bind("selectstart.slimscroll",function(e){e.stopPropagation();e.preventDefault();return!1});C.hover(function(){l()},function(){c()});N.hover(function(){d=!0},function(){d=!1});x.hover(function(){p=!0;l();c()},function(){p=!1;c()});x.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(g=e.originalEvent.touches[0].pageY)});x.bind("touchmove",function(e){S||e.originalEvent.preventDefault();e.originalEvent.touches.length&&(s((g-e.originalEvent.touches[0].pageY)/r.touchScrollStep,!0),g=e.originalEvent.touches[0].pageY)});u();"bottom"===r.start?(N.css({top:x.outerHeight()-N.outerHeight()}),s(0,!0)):"top"!==r.start&&(s(e(r.start).position().top,null,!0),r.alwaysVisible||N.hide());o()}});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery)